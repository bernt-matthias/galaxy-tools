<tool id="fls_rnachipintegrator_wrapper" name="Run RnaChipIntegrator" version="0.0.1">
  <description>to analyse gene expression and ChIP data</description>
  <command interpreter="bash">rnachipintegrator_wrapper.sh $rnaseq $chipseq $xls_output</command>
  <inputs>
    <param format="tabular" name="rnaseq" type="data" label="Gene expression data file" />
    <param format="tabular" name="chipseq" type="data" label="ChIP peaks data file" />
  </inputs>
  <outputs>
    <data format="xls" name="xls_output" label="RnaChipIntegrator analyses for ${rnaseq.name} vs ${chipseq.name}" />
  </outputs>
  <tests>
    <test>
      <param name="rnaseq" value="ExpressionData.txt" />
      <param name="chipseq" value="ChIP_peaks.txt" />
      <output name="xls_output" file="peaks.xls" compare="sim_size" />
    </test>
    <test>
      <param name="rnaseq" value="ExpressionData.txt" />
      <param name="chipseq" value="ChIP_edges.txt" />
      <output name="xls_output" file="peaks.xls" compare="sim_size" />
    </test>
  </tests>
  <help>

.. class:: infomark

**What it does**

Run RnaChipIntegrator to perform integrated analyses of gene expression
and ChIP data, identifying the nearest ChIP peaks to each transcript
and vice versa.

For ChIP peaks defined as regions the following analyses are performed:

* TranscriptsToPeakEdges: reports the nearest transcripts with the smallest
  distance from either their TSS or TES to the nearest peak edge.

* TSSToPeakEdges: reports the nearest transcripts with the smallest distance
  from their TSS to the nearest peak edge.

For ChIP peaks defined as summits:

* TSSToSummits: reports the nearest transcripts with the smallest distance
  from the TSS to the nearest peak summit.

* PeaksToTranscripts: reports the nearest peak summits with the smallest
  distance to either the TSS or TES of each transcript.

The program was originally written specifically for ChIP-Seq and RNA-Seq data
but works equally well for ChIP-chip and microarray expression data, and can
also be used to integrate any set of genomic features (e.g. canonical genes,
CpG islands) with expression data.

-------------

.. class:: infomark

**Input**

The expression data must be in a tab-delimited file with the following columns
of data for each genomic feature (one feature per line):

====== ========== ======================================================================
Column Name       Description
====== ========== ======================================================================
     1 chr        Chromosome name
     2 start      Start position of the feature
     3 end        End position of the feature
     4 strand     Must be either '+' or '-'
     5 diff_expr  Optional: indicates feature is differentially expressed (1) or not (0)
====== ========== ======================================================================

The ChIP-seq data must be in a tab-delimited file with 3 columns of data for each
ChIP peak (one per line):

====== ========== ======================================================================
Column Name       Description
====== ========== ======================================================================
     1 chr        Chromosome name (must match one of those in expression data file)
     2 start      Start position of the peak 
     3 end        End position of the peak (start + 1 for summit data)
====== ========== ======================================================================

The ChIP peak data can be either the summit (in which case 'end' - 'start' = 1) or the
entire extent of the binding region (with 'start' and 'end' indicating the limits).

-------------

.. class:: infomark

**Output**

An Excel spreadsheet with one page for each analysis performed.

  </help>
</tool>