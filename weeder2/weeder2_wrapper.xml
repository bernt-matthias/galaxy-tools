<tool id="motiffinding_weeder2" name="Weeder2" version="2.0.0">
  <description>Motif discovery in sequences from coregulated genes of a single species</description>
  <command interpreter="bash">weeder2_wrapper.sh
  $sequence_file $species_code
  $output_motifs_file $output_matrix_file
  $strands
  #if $chipseq.use_chipseq
     -chipseq -top $chipseq.top
  #end if
  #if str( $advanced_options.advanced_options_selector ) == "on"
     -maxm $advanced_options.n_motifs_report
     -b $advanced_options.n_motifs_build
     -sim $advanced_options.sim_threshold
     -em $advanced_options.em_cycles
  #end if
</command>
  <requirements>
    <requirement type="package" version="2.0">weeder</requirement>
  </requirements>
  <inputs>
    <param name="sequence_file" type="data" format="fasta" label="Input sequence" />
    <param name="species_code" type="select" label="Species to use for background comparison">
      <!-- Hard code options for now
	   See weeder's "organisms.txt" for full list
      -->
      <option value="HS">Homo sapiens (HS)</option>
      <option value="MM">Mus musculus (MM)</option>
      <option value="DM">Drosophila melanogaster (DM)</option>
      <option value="SC">Saccharomyces cerevisiae (SC)</option>
      <option value="AT">Arabidopsis thaliana (AT)</option>
    </param>
    <param name="strands" label="Use both strands of sequence" type="boolean"
	   truevalue="" falsevalue="-ss" checked="True"
	   help="If not checked then use -ss option" />
    <conditional name="chipseq">
      <param name="use_chipseq" type="boolean"
	     label="Use the ChIP-seq heuristic"
	     help="Speeds up the computation (-chipseq)"
	     truevalue="yes" falsevalue="no" checked="on" />
      <when value="yes">
	<param name="top" type="integer" value="100"
	       label="Number of top input sequences with oligos to scan for"
	       help="Increase this value to improve the chance of finding motifs enriched only in a subset of your input sequences (-top)" />
      </when>
      <when value="no"></when>
    </conditional>
    <conditional name="advanced_options">
      <param name="advanced_options_selector" type="select"
	     label="Display advanced options">
	<option value="off">Hide</option>
	<option value="on">Display</option>
      </param>
      <when value="on">
	<param name="n_motifs_report" type="integer" value="25"
	       label="Number of discovered motifs to report" help="(-maxm)" />
	<param name="n_motifs_build" type="integer" value="50"
	       label="Number of top scoring motifs to build occurrences matrix profiles and outputs for"
	       help="(-b)" />
	<param name="sim_threshold" type="float" min="0.0" max="1.0" value="0.95"
	       label="Similarity threshold for the redundancy filter"
	       help="Remove motifs that are too similar, with lower values imposing a stricter filter. Must be between 0.0 and 1.0 (-sim)" />
	<param name="em_cycles" type="integer" min="0" max="100" value="1"
	       label="Number of expectation maximization (EM) cycles to perform"
	       help="Number of cycles must be between 0 and 100 (-em)" />
      </when>
      <when value="off">
      </when>
    </conditional>
  </inputs>
  <outputs>
    <data name="output_motifs_file" format="txt" label="Weeder2 on ${on_string} (motifs)" />
    <data name="output_matrix_file" format="txt" label="Weeder2 on ${on_string} (matrix)" />
  </outputs>
  <help>

.. class:: infomark

**What it does**

Weeder2 is a program for finding novel motifs (transcription factor binding sites)
conserved in a set of regulatory regions of related genes.

-------------

.. class:: infomark

**Credits**

This Galaxy tool has been developed within the Bioinformatics Core Facility at the
University of Manchester. It runs the Weeder motif finding package which has
been developed by Giulio Pavesi at the University of Milan, Italy.

This tool is compatible with Weeder 2.0:

 * http://159.149.160.51/modtools/downloads/weeder2.html

Please kindly acknowledge both this Galaxy tool, the Weeder package and the utility
scripts if you use it in your work.
  </help>
</tool>
